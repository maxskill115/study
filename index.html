<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Finger Math - Luy·ªán T√≠nh Nh·∫©m</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Audio is managed by app.js -->
    
    <style>
        /* TLBB Enhanced Menu Animations */
        @keyframes fadeIn {
            from { opacity: 0; backdrop-filter: blur(0px); }
            to { opacity: 1; backdrop-filter: blur(15px); }
        }
        

        

    </style>
</head>
<body>
    <!-- ENHANCED HAMBURGER MENU FOR GAME SWITCHING -->
    <div id="game-menu" style="
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        background: linear-gradient(135deg, rgba(0, 30, 60, 0.95), rgba(0, 20, 40, 0.9));
        border: 2px solid #88ccff;
        border-radius: 12px;
        padding: 12px 16px;
        cursor: pointer;
        color: #88ccff;
        font-size: 20px;
        backdrop-filter: blur(15px);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        box-shadow: 
            0 0 20px rgba(136, 204, 255, 0.3),
            inset 0 0 15px rgba(136, 204, 255, 0.05);
        font-weight: bold;
        text-shadow: 0 0 10px #88ccff;
        user-select: none;
    " onclick="showGameSelector()" title="Tr·∫°m ƒêi·ªÅu Khi·ªÉn - Ch·ªçn Game"
    onmouseover="
        this.style.transform = 'scale(1.1) rotate(90deg)';
        this.style.boxShadow = '0 0 30px rgba(136, 204, 255, 0.6), inset 0 0 20px rgba(136, 204, 255, 0.1)';
        this.style.borderColor = '#ffdd88';
        this.style.color = '#ffdd88';
    "
    onmouseout="
        this.style.transform = 'scale(1) rotate(0deg)';
        this.style.boxShadow = '0 0 20px rgba(136, 204, 255, 0.3), inset 0 0 15px rgba(136, 204, 255, 0.05)';
        this.style.borderColor = '#88ccff';
        this.style.color = '#88ccff';
    "
    onmousedown="this.style.transform = 'scale(0.95) rotate(90deg)'"
    onmouseup="this.style.transform = 'scale(1.1) rotate(90deg)'">
        ‚ò∞
    </div>

    <!-- GAME SELECTOR OVERLAY -->
    <!-- ENHANCED TLBB STYLE GAME SELECTOR OVERLAY -->
    <div id="game-selector-overlay" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 20, 40, 0.9));
        z-index: 10000;
        display: none;
        backdrop-filter: blur(15px);
        animation: fadeIn 0.5s ease-out;
    " onclick="hideGameSelector()">
        <div style="
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #0a1a2a 0%, #1a2a3a 50%, #0a1a2a 100%);
            border: 3px solid #88ccff;
            border-radius: 25px;
            padding: 40px 35px;
            text-align: center;
            color: #88ccff;
            min-width: 380px;
            max-width: 450px;
            box-shadow: 
                0 0 50px rgba(136, 204, 255, 0.4),
                inset 0 0 30px rgba(136, 204, 255, 0.05);
            position: relative;
            overflow: hidden;
        " onclick="event.stopPropagation()">
            
            <!-- Decorative Header -->
            <div style="
                background: linear-gradient(90deg, transparent, #88ccff, transparent);
                height: 2px;
                width: 80%;
                margin: 0 auto 20px auto;
                opacity: 0.6;
            "></div>
            
            <h2 style="
                color: #88ccff; 
                margin-bottom: 25px;
                font-size: 28px;
                text-shadow: 0 0 20px #88ccff;
                font-weight: bold;
            ">üåü TR·∫†M ƒêI·ªÄU KHI·ªÇN</h2>
            
            <p style="
                color: #888;
                margin-bottom: 30px;
                font-size: 14px;
            ">Ch·ªçn nhi·ªám v·ª• ƒë·ªÉ ti·∫øp t·ª•c h√†nh tr√¨nh</p>
            
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <button onclick="window.location.href='./main.html'" class="game-nav-btn" style="
                    background: linear-gradient(135deg, rgba(136, 204, 255, 0.2), rgba(100, 180, 255, 0.1));
                    border: 2px solid #88ccff;
                    color: #88ccff;
                    padding: 15px 20px;
                    border-radius: 15px;
                    cursor: pointer;
                    font-size: 16px;
                    font-weight: bold;
                    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                    position: relative;
                    overflow: hidden;
                    text-shadow: 0 0 10px rgba(136, 204, 255, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                ">
                    <span style="font-size: 20px;">üè†</span>
                    <span>TR·∫†M CH√çNH - Menu T·ªïng</span>
                </button>
                
                <button onclick="window.location.href='./to√°n ch∆°i.html'" class="game-nav-btn" style="
                    background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 180, 0, 0.1));
                    border: 2px solid #ffdd88;
                    color: #ffdd88;
                    padding: 15px 20px;
                    border-radius: 15px;
                    cursor: pointer;
                    font-size: 16px;
                    font-weight: bold;
                    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                    position: relative;
                    overflow: hidden;
                    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                ">
                    <span style="font-size: 20px;">üöÄ</span>
                    <span>TO√ÅN CH∆†I - Asteroid Miner</span>
                </button>
                
                <button onclick="window.location.href='./tu ti√™n.html'" class="game-nav-btn" style="
                    background: linear-gradient(135deg, rgba(255, 51, 51, 0.2), rgba(200, 0, 0, 0.1));
                    border: 2px solid #ff6666;
                    color: #ff6666;
                    padding: 15px 20px;
                    border-radius: 15px;
                    cursor: pointer;
                    font-size: 16px;
                    font-weight: bold;
                    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                    position: relative;
                    overflow: hidden;
                    text-shadow: 0 0 10px rgba(255, 51, 51, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                ">
                    <span style="font-size: 20px;">‚öîÔ∏è</span>
                    <span>TU TI√äN - Thi√™n ƒê·∫°o RPG</span>
                </button>
            </div>
            
            <!-- Close Button -->
            <button onclick="hideGameSelector()" style="
                background: linear-gradient(135deg, rgba(255, 51, 51, 0.3), rgba(200, 0, 0, 0.2));
                border: 2px solid #ff6666;
                color: #ff6666;
                padding: 12px 20px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 14px;
                font-weight: bold;
                margin-top: 25px;
                transition: all 0.3s ease;
                text-shadow: 0 0 10px rgba(255, 51, 51, 0.5);
            " onmouseover="this.style.background='linear-gradient(135deg, rgba(255, 51, 51, 0.5), rgba(200, 0, 0, 0.3))'; this.style.transform='scale(1.05)'" onmouseout="this.style.background='linear-gradient(135deg, rgba(255, 51, 51, 0.3), rgba(200, 0, 0, 0.2))'; this.style.transform='scale(1)'">
                ‚úñ ƒê√ìNG TR·∫†M
            </button>
            
            <!-- Decorative corners -->
            <div style="
                position: absolute;
                top: 10px;
                left: 10px;
                width: 25px;
                height: 25px;
                border-top: 3px solid #88ccff;
                border-left: 3px solid #88ccff;
                opacity: 0.7;
            "></div>
            <div style="
                position: absolute;
                top: 10px;
                right: 10px;
                width: 25px;
                height: 25px;
                border-top: 3px solid #88ccff;
                border-right: 3px solid #88ccff;
                opacity: 0.7;
            "></div>
            <div style="
                position: absolute;
                bottom: 10px;
                left: 10px;
                width: 25px;
                height: 25px;
                border-bottom: 3px solid #88ccff;
                border-left: 3px solid #88ccff;
                opacity: 0.7;
            "></div>
            <div style="
                position: absolute;
                bottom: 10px;
                right: 10px;
                width: 25px;
                height: 25px;
                border-bottom: 3px solid #88ccff;
                border-right: 3px solid #88ccff;
                opacity: 0.7;
            "></div>
        </div>
    </div>

    <div class="container">
        <!-- M√ÄN H√åNH CH√çNH -->
        <div id="home-screen" class="screen active">
            <h1>üñêÔ∏è Finger MathüñêÔ∏è 1</h1>
            <h2>Luy·ªán T√≠nh Nh·∫©m Cho B√©</h2>

            <!-- Ch·ªçn m·ª©c ƒë·ªô (multi-select) -->
            <div class="settings-group">
                <label>üìä M·ª©c ƒë·ªô: <span class="hint">(c√≥ th·ªÉ ch·ªçn nhi·ªÅu)</span></label>
                <div class="button-group">
                    <button class="option-btn active" data-setting="level" data-value="unit">H√†ng ƒë∆°n v·ªã</button>
                    <button class="option-btn" data-setting="level" data-value="tens">H√†ng ch·ª•c</button>
                    <button class="option-btn" data-setting="level" data-value="hundreds">H√†ng trƒÉm</button>
                    <button class="option-btn" data-setting="level" data-value="thousands">H√†ng ngh√¨n</button>
                </div>
            </div>

            <!-- Ch·ªçn d·∫°ng to√°n -->
            <div class="settings-group">
                <label>üé≤ D·∫°ng to√°n:</label>
                <div class="button-group">
                    <button class="option-btn active" data-setting="problemType" data-value="quick-math">‚ö° T√≠nh nhanh</button>
                    <button class="option-btn" data-setting="problemType" data-value="find-x">üîç T√¨m X</button>
                    <button class="option-btn" data-setting="problemType" data-value="word-problem">üìñ To√°n ƒê·ªë</button>
                </div>
            </div>

            <!-- Ch·ªçn ƒë·ªô kh√≥ (multi-select) -->
            <div class="settings-group">
                <label>‚ö° ƒê·ªô kh√≥: <span class="hint">(c√≥ th·ªÉ ch·ªçn nhi·ªÅu)</span></label>
                <div class="button-group">
                    <button class="option-btn active" data-setting="difficulty" data-value="no-carry">Kh√¥ng nh·ªõ</button>
                    <button class="option-btn" data-setting="difficulty" data-value="carry">C√≥ nh·ªõ</button>
                </div>
            </div>

            <!-- Ch·ªçn ph√©p t√≠nh (multi-select) -->
            <div class="settings-group">
                <label>‚ûï Ph√©p t√≠nh: <span class="hint">(c√≥ th·ªÉ ch·ªçn nhi·ªÅu)</span></label>
                <div class="button-group">
                    <button class="option-btn active" data-setting="operation" data-value="add">C·ªông (+)</button>
                    <button class="option-btn" data-setting="operation" data-value="subtract">Tr·ª´ (‚àí)</button>
                    <button class="option-btn" data-setting="operation" data-value="multiply">Nh√¢n (√ó)</button>
                    <button class="option-btn" data-setting="operation" data-value="divide">Chia (√∑)</button>
                </div>
            </div>

            <!-- Ch·ªçn ch·∫ø ƒë·ªô (ch·ªâ cho luy·ªán t·∫≠p) -->
            <div class="settings-group">
                <label>üéØ Ch·∫ø ƒë·ªô luy·ªán t·∫≠p:</label>
                <div class="button-group">
                    <button class="option-btn active" data-setting="mode" data-value="view">Xem k·∫øt qu·∫£</button>
                    <button class="option-btn" data-setting="mode" data-value="input">Nh·∫≠p k·∫øt qu·∫£</button>
                </div>
            </div>

            <!-- C√†i ƒë·∫∑t b√†i thi -->
            <div class="settings-group exam-settings">
                <label>üìù S·ªë c√¢u b√†i thi:</label>
                <div class="size-controls">
                    <button class="size-btn" data-action="exam-decrease">‚àí</button>
                    <span id="exam-count-display">10</span>
                    <button class="size-btn" data-action="exam-increase">+</button>
                </div>
            </div>

            <!-- 2 n√∫t ch√≠nh -->
            <div class="main-buttons">
                <button id="start-btn" class="primary-btn half-btn">‚ñ∂Ô∏è LUY·ªÜN T·∫¨P</button>
                <button id="exam-btn" class="primary-btn half-btn exam-btn-color">üìù B√ÄI THI</button>
            </div>

            <!-- N√∫t c√†i ƒë·∫∑t giao di·ªán (thu g·ªçn) -->
            <button id="toggle-settings-btn" class="toggle-settings-btn">‚öôÔ∏è C√†i ƒë·∫∑t giao di·ªán</button>
            
            <!-- C√†i ƒë·∫∑t giao di·ªán (·∫©n m·∫∑c ƒë·ªãnh) -->
            <div id="display-settings" class="settings-group display-settings hidden">
                <label>üé® T√πy ch·ªânh giao di·ªán:</label>
                <div class="setting-row">
                    <span>C·ª° ch·ªØ:</span>
                    <div class="size-controls">
                        <button class="size-btn" data-action="decrease">‚àí</button>
                        <span id="font-size-display">100%</span>
                        <button class="size-btn" data-action="increase">+</button>
                    </div>
                </div>
                <div class="setting-row">
                    <span>M√†u ch√≠nh:</span>
                    <input type="color" id="primary-color" value="#88ccff">
                </div>
                <div class="setting-row">
                    <span>M√†u ph·ª•:</span>
                    <input type="color" id="secondary-color" value="#ffd700">
                </div>
                <div class="setting-row">
                    <span>M√†u k·∫øt qu·∫£ ƒë√∫ng:</span>
                    <input type="color" id="correct-color" value="#00ff88">
                </div>
                <div class="setting-row">
                    <span>üîä √Çm l∆∞·ª£ng nh·∫°c n·ªÅn:</span>
                    <div class="size-controls">
                        <button class="size-btn" data-action="volume-decrease">‚àí</button>
                        <span id="volume-display">50%</span>
                        <button class="size-btn" data-action="volume-increase">+</button>
                    </div>
                </div>
                <button id="reset-settings-btn" class="reset-btn">üîÑ Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh</button>
            </div>
        </div>

        <!-- M√ÄN H√åNH LUY·ªÜN T·∫¨P -->
        <div id="practice-screen" class="screen">
            <div class="header">
                <button id="back-btn" class="back-btn">‚Üê Quay l·∫°i</button>
                <div class="problem-counter">B√†i s·ªë: <span id="problem-number">1</span></div>
                <button id="toggle-highlight-btn" class="toggle-highlight-btn hidden">üí°</button>
            </div>

            <div class="problem-area">
                <!-- Hi·ªÉn th·ªã c√¢u h·ªèi to√°n ƒë·ªë -->
                <div id="word-problem-text" class="word-problem-text hidden"></div>
                
                <!-- Hi·ªÉn th·ªã bi·ªÉu th·ª©c to√°n h·ªçc -->
                <div class="problem-display">
                    <span id="num1">0</span>
                    <span id="operator">+</span>
                    <span id="num2">0</span>
                    <span>=</span>
                    <span id="answer-display">?</span>
                </div>
            </div>

            <!-- Ch·∫ø ƒë·ªô A: Xem k·∫øt qu·∫£ -->
            <div id="mode-view" class="mode-section">
                <button id="show-answer-btn" class="primary-btn">XEM K·∫æT QU·∫¢</button>
            </div>

            <!-- Ch·∫ø ƒë·ªô B: Nh·∫≠p k·∫øt qu·∫£ -->
            <div id="mode-input" class="mode-section hidden">
                <div class="input-area">
                    <label class="input-label">ƒê√°p √°n c·ªßa con:</label>
                    <input type="text" inputmode="numeric" pattern="[0-9]*" id="user-answer">
                </div>
                <button id="check-btn" class="primary-btn">KI·ªÇM TRA</button>
            </div>

            <!-- Khu v·ª±c ph·∫£n h·ªìi -->
            <div id="feedback-area" class="feedback-area hidden">
                <div id="feedback-message" class="feedback-message"></div>
                <div id="correct-answer" class="correct-answer"></div>
            </div>

            <!-- N√∫t b√†i ti·∫øp theo -->
            <button id="next-btn" class="primary-btn next-btn hidden">B√ÄI TI·∫æP THEO ‚Üí</button>
        </div>

        <!-- M√ÄN H√åNH B√ÄI THI - T·ª´ng c√¢u m·ªôt -->
        <div id="exam-screen" class="screen">
            <div class="header">
                <button id="exam-back-btn" class="back-btn">‚Üê Quay l·∫°i</button>
                <button id="exam-toggle-highlight-btn" class="toggle-highlight-btn" title="B·∫≠t/T·∫Øt hi·ªÉn th·ªã ƒë·ªÅ b√†i">üí°</button>
                <div class="problem-counter">C√¢u: <span id="exam-current">1</span> / <span id="exam-total">10</span></div>
            </div>

            <div class="word-problem-text hidden" id="exam-word-problem-text"></div>

            <div class="problem-area" id="exam-problem-area">
                <div class="problem-display">
                    <span id="exam-num1">0</span>
                    <span id="exam-operator">+</span>
                    <span id="exam-num2">0</span>
                    <span>=</span>
                    <span id="exam-answer-display">?</span>
                </div>
            </div>

            <div class="input-area">
                <label class="input-label">Nh·∫≠p ƒë√°p √°n:</label>
                <input type="text" inputmode="numeric" pattern="[0-9-]*" id="exam-user-answer">
            </div>

            <div class="exam-nav-buttons">
                <button id="exam-prev-btn" class="primary-btn nav-btn">‚Üê QUAY L·∫†I</button>
                <button id="exam-next-btn" class="primary-btn nav-btn">TI·∫æP THEO ‚Üí</button>
            </div>
        </div>

        <!-- M√ÄN H√åNH XEM L·∫†I TR∆Ø·ªöC KHI N·ªòP -->
        <div id="review-screen" class="screen">
            <div class="header">
                <button id="review-back-btn" class="back-btn">‚Üê Ti·∫øp t·ª•c l√†m b√†i</button>
                <h2 class="review-title">üìã XEM L·∫†I B√ÄI THI</h2>
            </div>

            <div class="review-summary">
                <div class="summary-item done">
                    <span class="summary-label">‚úì ƒê√£ l√†m:</span>
                    <span id="done-count" class="summary-value">0</span>
                </div>
                <div class="summary-item not-done">
                    <span class="summary-label">‚óã Ch∆∞a l√†m:</span>
                    <span id="not-done-count" class="summary-value">0</span>
                </div>
            </div>

            <div class="review-list" id="review-list">
                <!-- Danh s√°ch c√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c sinh b·∫±ng JS -->
            </div>

            <button id="submit-exam-btn" class="primary-btn submit-btn">üì§ N·ªòP B√ÄI THI</button>
        </div>

        <!-- M√ÄN H√åNH K·∫æT QU·∫¢ B√ÄI THI -->
        <div id="result-screen" class="screen">
            <div class="result-container">
                <h1 class="result-title">üéâ K·∫æT QU·∫¢ B√ÄI THI</h1>
                
                <div class="result-score">
                    <div class="score-circle">
                        <span id="score-percent">0%</span>
                    </div>
                </div>

                <div class="result-details">
                    <div class="result-item correct-item">
                        <span class="result-label">‚úì S·ªë c√¢u ƒë√∫ng:</span>
                        <span id="correct-count" class="result-value">0</span>
                    </div>
                    <div class="result-item incorrect-item">
                        <span class="result-label">‚úó S·ªë c√¢u sai:</span>
                        <span id="incorrect-count" class="result-value">0</span>
                    </div>
                    <div class="result-item total-item">
                        <span class="result-label">üìä T·ªïng s·ªë c√¢u:</span>
                        <span id="total-count" class="result-value">0</span>
                    </div>
                </div>

                <div class="result-message excellent" id="result-message">
                    üéâ Con ƒë√£ ho√†n th√†nh b√†i thi!
                </div>

                <!-- B·∫£ng chi ti·∫øt k·∫øt qu·∫£ 3 c·ªôt -->
                <div class="result-table-container">
                    <table class="result-table">
                        <thead>
                            <tr>
                                <th>B√†i to√°n</th>
                                <th>ƒê√°p √°n</th>
                                <th>K·∫øt qu·∫£</th>
                            </tr>
                        </thead>
                        <tbody id="result-table-body">
                            <!-- S·∫Ω ƒë∆∞·ª£c sinh b·∫±ng JS -->
                        </tbody>
                    </table>
                </div>

                <button id="home-btn" class="primary-btn">üè† V·ªÄ TRANG CH·ª¶</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Enhanced Game Selector Functions with Beautiful Animations
        function showGameSelector() {
            const overlay = document.getElementById('game-selector-overlay');
            const panel = overlay.querySelector('div');
            
            overlay.style.display = 'block';
            overlay.style.opacity = '0';
            
            if (panel) {
                panel.style.transform = 'translate(-50%, -50%) scale(0.8) rotateY(-15deg)';
                panel.style.opacity = '0';
            }
            
            // Animate in
            setTimeout(() => {
                overlay.style.opacity = '1';
                overlay.style.transition = 'opacity 0.4s ease-out';
                
                if (panel) {
                    panel.style.transform = 'translate(-50%, -50%) scale(1) rotateY(0deg)';
                    panel.style.opacity = '1';
                    panel.style.transition = 'all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)';
                }
            }, 10);
            
            // Lock body scroll
            document.body.style.overflow = 'hidden';
        }
        
        function hideGameSelector() {
            const overlay = document.getElementById('game-selector-overlay');
            const panel = overlay.querySelector('div');
            
            // Animate out
            overlay.style.opacity = '0';
            overlay.style.transition = 'opacity 0.3s ease-in';
            
            if (panel) {
                panel.style.transform = 'translate(-50%, -50%) scale(0.8) rotateY(15deg)';
                panel.style.opacity = '0';
                panel.style.transition = 'all 0.4s cubic-bezier(0.55, 0.085, 0.68, 0.53)';
            }
            
            setTimeout(() => {
                overlay.style.display = 'none';
                
                // Restore body scroll
                document.body.style.overflow = '';
            }, 400);
        }
        
        // Close menu with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                hideGameSelector();
            }
        });
        
    </script>
</body>
</html>
